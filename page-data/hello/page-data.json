{"componentChunkName":"component---src-templates-blog-post-js","path":"/hello/","result":{"data":{"site":{"siteMetadata":{"title":"ìƒê°í•˜ë©´ì„œ ê°œë°œí•˜ê¸°"}},"markdownRemark":{"id":"fe84cafb-7960-5138-974e-7d3a27e02e97","excerpt":"ğŸŸï¸ ë™ì‹œì„± í™˜ê²½ì—ì„œ DB ë½ì„ ì´ìš©í•œ í‹°ì¼“ ì˜ˆì•½ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ âœ… í…ŒìŠ¤íŠ¸ ëª©í‘œ 100ê°œì˜ í‹°ì¼“ì„ ëŒ€ìƒìœ¼ë¡œ ìˆ˜ì²œ ëª…ì˜ ìœ ì €ê°€ ë™ì‹œì— ì˜ˆì•½ ìš”ì²­ì„ ë³´ëƒˆì„ ë•Œ, ë™ì‹œì„± ì´ìŠˆ ì—†ì´ ì •í™•íˆ 100ëª…ê¹Œì§€ë§Œ ì˜ˆì•½ë˜ë„ë¡ ì œì–´ë˜ëŠ”ì§€ ê²€ì¦í•œë‹¤.â€¦","html":"<h1>ğŸŸï¸ ë™ì‹œì„± í™˜ê²½ì—ì„œ DB ë½ì„ ì´ìš©í•œ í‹°ì¼“ ì˜ˆì•½ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸</h1>\n<h2>âœ… í…ŒìŠ¤íŠ¸ ëª©í‘œ</h2>\n<blockquote>\n<p>100ê°œì˜ í‹°ì¼“ì„ ëŒ€ìƒìœ¼ë¡œ ìˆ˜ì²œ ëª…ì˜ ìœ ì €ê°€ ë™ì‹œì— ì˜ˆì•½ ìš”ì²­ì„ ë³´ëƒˆì„ ë•Œ,</p>\n<p>ë™ì‹œì„± ì´ìŠˆ ì—†ì´ ì •í™•íˆ 100ëª…ê¹Œì§€ë§Œ ì˜ˆì•½ë˜ë„ë¡ ì œì–´ë˜ëŠ”ì§€ ê²€ì¦í•œë‹¤.</p>\n</blockquote>\n<h2>1ï¸âƒ£ ë½ì„ ì‚¬ìš©í•˜ì§€ ì•Šì€ ê²½ìš°</h2>\n<p>ğŸ”— <a href=\"https://www.notion.so/1e6ec761786c80e79875eb0214e770e8?pvs=21\">ì½”ë“œ ë³´ê¸°</a></p>\n<ul>\n<li>\n<p><strong>ì„¤ëª…</strong>:</p>\n<p>ë™ì‹œì„± ì œì–´ ì—†ì´ <code class=\"language-text\">reserveTicket()</code>ì„ í˜¸ì¶œí•œ ê¸°ë³¸ êµ¬í˜„.</p>\n</li>\n<li>\n<p><strong>ì‹œë‚˜ë¦¬ì˜¤</strong>:</p>\n<p><code class=\"language-text\">1000ëª…ì˜ ì‚¬ìš©ì</code>ê°€ ë™ì‹œì— 100ê°œì˜ í‹°ì¼“ì„ ì˜ˆì•½ ì‹œë„.</p>\n</li>\n<li>\n<p><strong>ê²°ê³¼</strong>:</p>\n<p>âŒ <strong>í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨</strong> â€“ ë™ì‹œì„± ì œì–´ ë¶€ì¬ë¡œ <strong>í‹°ì¼“ ìˆ˜ëŸ‰ ì´ˆê³¼ ì˜ˆì•½ ë°œìƒ</strong>.</p>\n</li>\n</ul>\n<h2>2ï¸âƒ£-1 ë¹„ê´€ì  ë½(Pessimistic Lock)ì„ ì ìš©í•œ ê²½ìš°</h2>\n<p>ğŸ”— <a href=\"https://www.notion.so/1e6ec761786c8071b72aed507a6744b0?pvs=21\">ì½”ë“œ ë³´ê¸°</a></p>\n<ul>\n<li>\n<p><strong>ì„¤ëª…</strong>:</p>\n<p><code class=\"language-text\">@Lock(LockModeType.PESSIMISTIC_WRITE)</code>ë¥¼ ì ìš©í•´ ë™ì‹œì— í•˜ë‚˜ì˜ í‹°ì¼“ë§Œ ìˆ˜ì • ê°€ëŠ¥í•˜ë„ë¡ ì œí•œ.</p>\n</li>\n<li>\n<p><strong>ì‹œë‚˜ë¦¬ì˜¤</strong>:</p>\n<p><code class=\"language-text\">10000ëª…ì˜ ì‚¬ìš©ì</code>ê°€ ë™ì‹œì— 100ê°œì˜ í‹°ì¼“ì„ ì˜ˆì•½ ì‹œë„.</p>\n</li>\n<li>\n<p><strong>ê²°ê³¼</strong>:</p>\n<p>âœ… <strong>í…ŒìŠ¤íŠ¸ ì„±ê³µ</strong> â€“ ì •í™•íˆ <code class=\"language-text\">100ëª…ë§Œ ì˜ˆì•½</code>ë¨.</p>\n</li>\n<li>\n<p>ë¬¸ì œì :</p>\n<ul>\n<li>ì‚¬ìš©ì 10,000ëª…ì„ <code class=\"language-text\">ê°œë³„ì ìœ¼ë¡œ ì €ì¥</code>í•´ í…ŒìŠ¤íŠ¸ ì‹œê°„ì´ ë§¤ìš° ê¸¸ì–´ì§.\n<ul>\n<li><strong>í•´ê²° ë°©ë²•</strong> : <strong>ë²Œí¬ Insert (<code class=\"language-text\">saveAll()</code>) ì‚¬ìš©</strong></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2>2ï¸âƒ£-2 saveAll() í™œìš©í•œ ë²Œí¬ Insert ì‹œë„</h2>\n<p>ğŸ”— <a href=\"https://www.notion.so/1e7ec761786c8029b92ec2956086b59f?pvs=21\">ì½”ë“œ ë³´ê¸°</a></p>\n<ul>\n<li>\n<p><strong>ì„¤ëª…</strong>:</p>\n<p><code class=\"language-text\">saveAll()</code>ë¡œ ì‚¬ìš©ì 10,000ëª…ì„ í•œ ë²ˆì— ì €ì¥.</p>\n</li>\n<li>\n<p><strong>ë¬¸ì œì </strong>:</p>\n<ul>\n<li>ë‚´ë¶€ì ìœ¼ë¡œ ì—¬ì „íˆ <code class=\"language-text\">persist()</code>ë¥¼ ë£¨í”„ ëŒë©° í˜¸ì¶œ â†’ <code class=\"language-text\">ì¿¼ë¦¬ Në²ˆ ë°œìƒ</code>.</li>\n<li>ì¦‰, <strong>ì‹¤ì œ ë²Œí¬ ì„±ëŠ¥ì€ ê¸°ëŒ€ë³´ë‹¤ ë‚®ìŒ</strong>.</li>\n</ul>\n</li>\n<li>\n<p><strong>í•´ê²° ë°©ì•ˆ</strong>:</p>\n<p>Hibernateì˜ <strong>Batch Insert ì„¤ì •</strong> + <code class=\"language-text\">EntityManager</code> ì§ì ‘ ì‚¬ìš©.</p>\n</li>\n</ul>\n<h2>2ï¸âƒ£-3 EntityManager + @Transactional ë°©ì‹ ì ìš©</h2>\n<p>ğŸ”— <a href=\"https://www.notion.so/1e7ec761786c801f9749e72c3c3e3177?pvs=21\">ì½”ë“œ ë³´ê¸°</a></p>\n<ul>\n<li>\n<p><strong>ì„¤ëª…</strong>:</p>\n<p><code class=\"language-text\">@PersistenceContext</code>ë¡œ ì£¼ì…í•œ <code class=\"language-text\">EntityManager</code>ë¥¼ í†µí•´ <code class=\"language-text\">flush()</code> &#x26; <code class=\"language-text\">clear()</code>ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ í˜¸ì¶œí•˜ë©° batch ì²˜ë¦¬.</p>\n</li>\n<li>\n<p><strong>ë¬¸ì œ ë°œìƒ</strong>:\nâŒ <strong><code class=\"language-text\">@Transactional</code>ì´ ì ìš©ë˜ì§€ ì•ŠìŒ</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\n@Transactional self-invocation (in effect, a method within the target object calling another method of the target object) does not lead to an actual transaction at runtime</code></pre></div>\n</li>\n<li>\n<p><strong>ì´ìœ </strong>:</p>\n<ul>\n<li>Springì€ <strong>AOP ê¸°ë°˜ìœ¼ë¡œ íŠ¸ëœì­ì…˜ ì²˜ë¦¬</strong></li>\n<li><strong>ê°™ì€ í´ë˜ìŠ¤ ë‚´ì—ì„œ ë©”ì„œë“œ í˜¸ì¶œ(this)</strong> â†’ <strong>í”„ë¡ì‹œ ìš°íšŒ</strong> â†’ íŠ¸ëœì­ì…˜ ì ìš© ì•ˆ ë¨</li>\n</ul>\n</li>\n</ul>\n<h2>2ï¸âƒ£-4 Self-Invocation ë¬¸ì œ í•´ê²°: Self ì£¼ì… êµ¬ì¡° ë„ì…</h2>\n<p>ğŸ”— <a href=\"https://www.notion.so/1e7ec761786c803aa370e19889828cbb?pvs=21\">ì½”ë“œ ë³´ê¸°</a></p>\n<ul>\n<li>\n<p><strong>ì„¤ëª…</strong>:</p>\n<p><code class=\"language-text\">this.insertUsersInBulk()</code> ëŒ€ì‹ , <strong>Beanìœ¼ë¡œ ì£¼ì…ëœ ìì‹ (Self)</strong> ì„ í†µí•´ í˜¸ì¶œ</p>\n</li>\n<li>\n<p><strong>ë¬¸ì œ ë°œìƒ</strong>:\nâŒ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì— <code class=\"language-text\">@Autowired TicketReservationServiceTest</code> â†’</p>\n<p><code class=\"language-text\">Could not autowire. No beans of 'TicketReservationServiceTest' type found.</code></p>\n</li>\n<li>\n<p><strong>ì´ìœ </strong>:</p>\n</li>\n<li>\n<p><code class=\"language-text\">@Transactional</code>ì´ ë¶™ì€ <code class=\"language-text\">insertUsersInBulk()</code>ë¥¼ ê°™ì€ í´ë˜ìŠ¤ ë‚´ì—ì„œ í˜¸ì¶œí•˜ê³  ìˆì–´ì„œ <strong>íŠ¸ëœì­ì…˜ì´ ì ìš©ë˜ì§€ ì•Šê³ </strong>, ê·¸ ê²°ê³¼ <code class=\"language-text\">EntityManager</code>ê°€ íŠ¸ëœì­ì…˜ ë°”ê¹¥ì—ì„œ ì‹¤í–‰ë˜ë©° ì˜¤ë¥˜ê°€ ë°œìƒ</p>\n</li>\n<li>\n<p>í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ëŠ” <code class=\"language-text\">@SpringBootTest</code>ë¡œ ì‹¤í–‰ë˜ì§€ë§Œ, ì¼ë°˜ì ì¸ <strong>Spring Beanìœ¼ë¡œ ë“±ë¡ë˜ì§€ ì•ŠìŒ</strong></p>\n</li>\n</ul>\n<h2>2ï¸âƒ£-5 ìµœì¢… í•´ê²° â€“ ë²Œí¬ Insert ì „ìš© ì„œë¹„ìŠ¤ ë¶„ë¦¬</h2>\n<p>ğŸ”— <a href=\"https://www.notion.so/1e7ec761786c801c8bade22af1bdabc2?pvs=21\">ì½”ë“œ ë³´ê¸°</a></p>\n<ul>\n<li>\n<p><strong>ì„¤ëª…</strong>:\n<code class=\"language-text\">@Service</code> í´ë˜ìŠ¤ë¡œ <code class=\"language-text\">InsertUsersInBulkService</code>ë¥¼ ë¶„ë¦¬í•˜ê³ ,</p>\n<p>ì—¬ê¸°ì— <code class=\"language-text\">@Transactional</code>ê³¼ <code class=\"language-text\">EntityManager</code>ë¥¼ ì ìš©í•´ ì˜¬ë°”ë¥¸ íŠ¸ëœì­ì…˜ ì²˜ë¦¬ êµ¬í˜„.</p>\n</li>\n<li>\n<p><strong>ê²°ê³¼</strong>:\n<strong>íŠ¸ëœì­ì…˜ ì •ìƒ ë™ì‘ + ë¹ ë¥¸ ëŒ€ìš©ëŸ‰ insert ì²˜ë¦¬</strong></p>\n<p><strong>í…ŒìŠ¤íŠ¸ ì„±ê³µ</strong></p>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>í…ŒìŠ¤íŠ¸ ë°©ì‹</th>\n<th>ê²°ê³¼</th>\n<th>ë™ì‹œì„± ì œì–´</th>\n<th>ì„±ëŠ¥ ë¬¸ì œ</th>\n<th>íŠ¸ëœì­ì…˜ ë¬¸ì œ</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ë‹¨ìˆœ ë¡œì§</td>\n<td>âŒ ì‹¤íŒ¨</td>\n<td>âŒ ì—†ìŒ</td>\n<td>âŒ ëŠë¦¼</td>\n<td>-</td>\n</tr>\n<tr>\n<td>Pessimistic Lock</td>\n<td>âœ… ì„±ê³µ</td>\n<td>âœ… ìˆìŒ</td>\n<td>âŒ ëŠë¦¼</td>\n<td>-</td>\n</tr>\n<tr>\n<td>saveAll()</td>\n<td>âœ… ì„±ê³µ</td>\n<td>âœ… ìˆìŒ</td>\n<td>âš ï¸ ê¸°ëŒ€ ì´í•˜</td>\n<td>-</td>\n</tr>\n<tr>\n<td>EntityManager</td>\n<td>âŒ ì‹¤íŒ¨</td>\n<td>âœ… ìˆìŒ</td>\n<td>âœ… ë¹ ë¦„</td>\n<td>âŒ ì ìš© ì•ˆ ë¨</td>\n</tr>\n<tr>\n<td>Self ì£¼ì… êµ¬ì¡°</td>\n<td>âŒ ì‹¤íŒ¨</td>\n<td>âœ… ìˆìŒ</td>\n<td>âœ… ë¹ ë¦„</td>\n<td>âŒ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ë¶ˆê°€</td>\n</tr>\n<tr>\n<td>ì„œë¹„ìŠ¤ ë¶„ë¦¬</td>\n<td>âœ… ì„±ê³µ</td>\n<td>âœ… ìˆìŒ</td>\n<td>âœ… ë¹ ë¦„</td>\n<td>âœ… ì •ìƒ ë™ì‘</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<p>ğŸ–‹ï¸ Written by <a href=\"https://github.com/tmdals1207\">í™ìŠ¹ë¯¼</a></p>","frontmatter":{"title":"","date":null,"description":null}},"previous":{"fields":{"slug":"/test-post/"},"frontmatter":{"title":"Test Post"}},"next":{"fields":{"slug":"/test1/"},"frontmatter":{"title":""}}},"pageContext":{"id":"fe84cafb-7960-5138-974e-7d3a27e02e97","previousPostId":"9f384cd9-2b83-584c-ba0d-0bfc6048a0f3","nextPostId":"7d953357-bccc-55b1-8700-4dc76837a96e"}},"staticQueryHashes":["2841359383"],"slicesMap":{}}